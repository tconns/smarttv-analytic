<!DOCTYPE html>
<html lang="en">
  <head>
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-7HWRG1H42Y"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-7HWRG1H42Y");
      console.log(window, window.gaGlobal);
      var clientId = '';
      var sended = false;
      gtag("get", "G-7HWRG1H42Y", "client_id", function(client_id){
        clientId = client_id;
        if(sended) return;
          window.parent.postMessage(JSON.stringify({event:'client_id', data: clientId }), '*');
         sended = true;
      });
      window.onload = function(){
        if(sended) return;
        if(clientId){
          window.parent.postMessage(JSON.stringify({event:'client_id', data: clientId }), '*');
          sended = true;
        }
      };
    </script>
  </head>
  <body>
  </body>
</html>
